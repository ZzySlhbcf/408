
# 3.2.1 SRAM芯片和DRAM芯片

RAM分为静态随机存储器(SRAM)和动态随机存储器(DRAM), 他们都是易失性存储器
+ 主存储器主要由DRAM
+ 靠近处理器的Cache则由SRAM实现

>[!note] 在访问RAM时, 访问时间与存储单元的物理地址无关

## SRAM的工作原理

存放一个二进制位的物理器称为**存储元**. 地址码相同的多个存储元构成一个**存储单元**, 若干个存储单元的集合构成**存储体**

SRAM的存储元是**双稳态触发器 (六晶体管MOS)**
**非破坏性读出**
**存取速度快, 集成度低, 功耗较大, 价格昂贵**, 一般用于**高速缓冲存储器(Cahce)和快表(TLB)**
## DRAM的工作原理

利用存储元电路中**栅极电容上的电荷**来存储信息, DRAM的基本存储元通常只使用一个晶体管
集成度高、位价低、功耗小
**存取速度比SRAM慢, 必须定时刷新和读后重生 (破坏性读出)**, 一般用于大容量的**主存系统**

对于同一行进行相邻两次刷新的时间间隔称为刷新周期, 通常取2ms
1. 集中刷新: 在一个刷新周期内, 利用一段固定时间, 依次对存储器的所有行进行逐一再生, 在此期间停止读写操作, 称为**死时间**, 也称访存死区
   + 读写操作期间不受刷新操作影响
   + 死区不能访存
1. 分散刷新: 将存储器工作周期分为两部分: 前半部分用于正常的读写操作; 后半部分用于刷新, **增加了系统的存取周期**
   + 没有死区
   + 加长了系统的存取周期
1. 异步刷新: 一个刷新周期内每行仅刷新一次, 将**刷新周期除以行数**, 得到相邻两行之间刷新的时间间隔t, 每隔t产生一次刷新请求
   + 使死区分布更加分散, 避免让CPU连续等待过长时间

>[!note] 行数越多, 死区时间越长



![[DRAM的刷新方式.png]]

>[!info] DRAM的刷新需要注意
>1. 刷新对CPU是透明的, 不依赖外部的访问
>2. **DRAM的刷新单位是行**, 由芯片内部自行生成行地址
>3. 刷新操作类似读写操作
>4. 刷新时不需要选片, 即整个存储器中的所有芯片同时被刷新

DRAM芯片内容较大, 地址位数较多, 通常采用地址引脚复用技术: 行地址和列地址通过相同的引脚分先后两次输入

+ 假定有一个$2^n\times b$位的DRAM芯片, 其行数为r, 列数为c, 则$2^n=r\times c$, 存储阵列的地址位数为n, 其中行地址位数为$\log_{2}r$, 列地址位数为$\log_{2}c$, 则$n=\log_{2}r+\log_{2}c$
+ 由于DRAM芯片采用地址引脚复用技术, 为减少地址引脚数, 应该尽量使行列位数相同, 即满足$|r-c|$最小
+ DRAM按行刷新, 为减少刷新开销, 应使行数较少, 因此还需满足$r\leqslant c$

![[DRAM内部结构.png]]

芯片内部有一个**行缓冲器**, 用来缓存指定行中每列的数据, 其大小为列数$\times$存储元的位数, **常用SRAM实现**
选中某行后, 改行的所有数据被送入行缓冲器, 以后每个时钟都可以连续地从DRAM中输出一个数据, 因此可以支持**突发传输 (在寻址阶段给出数据地首地址, 在传输阶段可以传送多个连续存储单元地数据)**

>[!info] SDRAM (同步DRAM)
>与异步DRAM不同, SDRAM与CPU的数据交换同步于系统的时钟信号, 并且以CPU-主存总线的最高速度运行, 而不需要插入等待状态
>+ DRAM: CPU将地址和控制信号送至存储器后, 需经过一段延迟时间, 数据才能读写, 在读写完成之前, **CPU不能做其他工作, 降低了CPU的执行速度**
>+ SDRAM: 在系统时钟的控制下进行数据的读写, 将CPU发出的地址和控制信号锁存起来, 经过指定的时钟周期后再响应, 此时CPU可执行其他操作
## SRAM和DRAM的比较

![[SRAM和DRAM各自的特点.png]]

## 存储器芯片的内部结构

![[存储芯片内部的结构.png]]

1. 存储体: 存储矩阵, 由行选择线X和列选择线Y来选择所访问单元, 存储体的相同行、列上的多位同时被读或写
2. 地址译码器: 用来将地址转换为译码输出线上的高电平, 以便驱动相应的读/写电路
  + 单译码法: 只有一个行译码器, 同一行中所有存储单元的字线连在一起, 同一行中的各单元构成一个字, 被同时读出或写入. 
    **缺点是地址译码器的输出线数过多** 
  + 双译码法: 地址译码器分为X和Y两个译码器, 在选中的行和列交叉点上能确定一个存储单元, 这是DRAM芯片目前普遍采用的译码结构
1. I/O电路: 用以控制被选中的单元的读出或写入, **具有放大信号的作用**
2. 片选控制线: 单个芯片容量太小, 往往满足不了计算机对存储器容量的要求, 因此需用一定数量的芯片进行存储器的扩展. 在访问某个字时，必须"选中"该存储字所在的芯片, 而其他芯片不被“选中”, 因此需要有片选控制信号 (经片选控制线传输)
3. 读/写控制线: 根据CPU给出的读命令或写命令, 经读/写控制线控制被选中单元进行读或写

## 双端口RAM

> 作用：优化多核CPU访问一根内存条的速度

操作系统：读者--写者问题

解决方案：置“忙”信号，由判断逻辑决定暂时关闭端口（即被延时），为被关闭的端口正常访问，被关闭的端口延长一个很短的时间访问

# 3.2.2 只读存储器

## 只读存储器(ROM)的特点

1. 结构简单, 位密度比可读写存储器高
2. 具有非易失性, 可靠性高

## ROM的类型

1. 掩模式只读存储器(MROM): 由半导体制造厂商按用户提出的要求在芯片的生产过程中直接写入, 写入以后任何人都无法改变其内容
   优点是可靠性高、集成度高、价格便宜
   缺点是灵活性差
2. 一次可编程只读存储器(PROM): 是可以**实现一次性编程的只读存储器, 允许用户利用专门的设备(编程器)写入自己的程序**, 一旦写入, 内容就无法改变
3. 可擦除可编程只读存储器(EPROM): **不仅可以由用户利用编程器写入信息，而且可以对其内容进行多次改写**
   EPROM虽然既可读又可写, 但它不能取代RAM, 因为**EPROM的编程次数有限，且写入时间过长**
4. Flash存储器: 是在EPROM的基础上发展起来的, 它兼有ROM和RAM的优点
   **可在不加电的情况下长期保存信息, 又能在线进行快速擦除与重写**
   有EPROM**价格便宜、集成度高的优点**
   有E${}^2$PROM**电可擦除重写的特点, 且擦除重写的速度快** ^e90aab
5. 固态硬盘(SSD): 基于闪存的固态硬盘是用固态电子存储芯片阵列制成的硬盘, 由控制单元和存储单元 (Flash芯片)组成
   保留了Flash存储器**长期保存信息、快速擦除与重写的特性**
   对比传统硬盘也具有**读写速度快、低功耗的特点, 缺点是价格较高**

# 3.2.3 主存储器的基本组成

![[主存储器的基本组成框图.png]]


# 3.2.4 多模块存储器

## 单体多字存储器

## 多体并行存储器

每个模块都有相同的容量和存取速度。
各模块都有独立的读写控制电路、地址寄存器和数据寄存器。他们既能并行工作，又能交叉工作

每个存储体存取周期为T:存取时间为r，假设T=4r

高位交叉编址的多体存储器：需要5T

低位交叉编址的多体存储器：连续取n个存取字，耗时T+(n-1)r
>[!info] 保证模块数$m\geqslant T/r$



### 高位交叉编址 (顺序方式)

### 低位交叉编址 (交叉方式)

