# 3.4.1 磁盘存储器

1. 存储容量大, 位价低
2. 记录介值可重复使用
3. 记录信息可长期保存而不丢失, 甚至可以脱机存档
4. 非破坏性读出, 读出时不需要再生
5. 存取时间慢, 机械结构复杂, 对工作环境要求较高

## 磁盘存储器

### 磁盘设备的组成

1. 磁盘存储器: 磁盘驱动器、磁盘控制器和盘片
   + 磁盘驱动器: 驱动磁盘转动并在盘面上通过磁头进行读写操作的装置
   + 磁盘控制器: 磁盘驱动器与主机的接口, 负责接收并解释CPU发来的命令, 向磁盘驱动器发出各种控制信号, 并负责检测磁盘驱动器的状态
1. 存储区域: 记录面->磁道->扇区(块): 磁盘最小的读写单位
   + 磁头数(Head): 记录面数, 有多少个磁头, 磁头用于读取盘片上记录面的信息和写入信息
   + 柱面数: 有多少条磁道, 不同记录面的相同编号位置的磁道构成一个圆柱面
   + 扇区数: 表示每条磁道上有多少个扇区

>[!note] 相邻磁道及扇区间通过一定的间隔分开, 以避免精度错误
>扇区按固定圆心角度划分, 位密度从最外道向里道增加, 磁盘的存储能力受限于最内道的最大记录密度

3. 磁盘高速缓存: 在内存中开辟一部分区域, 用于缓冲将被送到磁盘上的数据
   + 写磁盘是按"簇"进行的, 可以避免频繁地用小块数据写盘
   + 有些中间结果数据在写回磁盘之前可被快速利用
### 磁记录原理

> 磁头和磁性记录介值相对运动时吗通过电磁转换完成读写操作

编码方式: 按某种规律, 把一传二进制数据变换成存储介值磁层中一个磁化翻转状态地序列, 并使读写控制电路容易、可靠地实现转换
磁记录方式: 调频制 (FM)和改进型调频制 (MFM)

### 磁盘的性能指标

记录密度: 单位面积上地二进制数据量, 道密度、位密度和面密度

磁盘容量: 
+ 非格式化容量: 磁记录表面可利用地磁化单元总数=记录面数\*柱面数\*每条磁道的磁化单元数
+ 格式化容量: 按照某种特定的记录格式所能存储的信息总量=记录面数\*柱面数\*每道扇区数\*每个扇区的容量

存取时间: 寻道时间(磁道)、旋转延迟时间(扇区)、传输时间
+ 寻道时间取从外到内的时间的一半、旋转延迟时间取旋转半周的时间

数据传输速率: 单位时间向主机传送数据的字节数
+ 假设磁盘的转速位r转/s, 每条磁道容量为N字节
$$
D_{r}=rN
$$

### 磁盘地址

![[磁盘地址结构的计算.png]]

### 磁盘的工作过程

寻址、读盘、写盘,  每一个操作都对应一个控制字

取控制字->执行控制字

>[!note] 磁盘的读写操作是串行的吗不可能即读又写, 也不可能读或写两组数据
## 磁盘阵列

RAID (独立冗余磁盘阵列): 将多个独立的物理磁盘组成一个独立的逻辑盘

+ RAID0: 无冗余和无校验的磁盘阵列
  把连续的多个数据块交替地存放在不同物理磁盘中, 几个磁盘交叉并行读写, 即**条带化技术**, 但是没有容错能力
+ RAID1: 镜像磁盘阵列
  使两个磁盘同时进行读写, 互为备份
+ RAID2: 采用纠错的海明码的磁盘阵列
+ RAID3: 位交叉奇偶校验的磁盘阵列
+ RAID4: 块交叉奇偶校验的磁盘阵列
+ RAID5: 无独立校验的奇偶校验磁盘阵列

# 3.4.2 固态硬盘

## 固态硬盘的特性

SSD是一种**基于闪存[[3.2 主存储器#^e90aab|Flash]]的存储器**, 由一个或多个闪存芯片和闪存翻译层组成
闪存芯片: 代替机械驱动器
闪存翻译层: 将来自CPU的逻辑块读写请求翻译成对底层物理设备的读写控制信号, 相当于磁盘控制器

![[SSD的结构组成.png]]

一个闪存由B个块组成, 每块由P个页组成

数据以页位单位读写, 以块为单位擦除, 只有在一页所属的块被整个被擦除后, 才能写这一页
某个块进行了若干次重复写后, 就会磨损

若写操作试图修改一个包含已有数据的页P, 则这个块中所有含有用数据的页都必须被复制到一个新的块中

+ 由半导体存储器构成, 没有移动的部件, 因此随机访问的时间比机械磁盘块
+ 没有任何机械噪声和振动, 能耗更低, 抗震性好, 安全性高
## 磨损均衡

1. 动态磨损均衡: 写入数据时, 优先选择擦除次数少的新闪存块
2. 静态磨损均衡: SSD会检测并自动进行数据分配, 让老闪存块承担以读为主的存储任务